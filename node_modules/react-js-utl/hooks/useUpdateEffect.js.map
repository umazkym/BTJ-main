{"version":3,"sources":["../src/hooks/useUpdateEffect.js"],"names":["useRef","useEffect","isArray","useUpdateEffect","fn","deps","isInitialRenderRef","length","current","shouldBreak","rand","Math","random","i","value"],"mappings":";;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,SAASA,MAAT,EAAiBC,SAAjB,QAAkC,OAAlC;AACA,SAASC,OAAT,QAAwB,QAAxB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,eAAe,SAASC,eAAT,CAAyBC,EAAzB,EAA4C;AAAA,MAAfC,IAAe,uEAAR,KAAK,CAAG;AACzD,MAAMC,kBAAkB,GAAGN,MAAM,CAAC,IAAD,CAAjC;;AACA,MAAIE,OAAO,CAACG,IAAD,CAAX,EAAmB;AACjB;AACA;AACA,QAAIA,IAAI,CAACE,MAAT,EAAiB;AACf,UAAID,kBAAkB,CAACE,OAAvB,EAAgC;AAC9BH,QAAAA,IAAI,sBAAOA,IAAP,CAAJ;AACA,YAAII,WAAW,GAAG,KAAlB;;AACA,eAAO,IAAP,EAAa;AACX,cAAMC,IAAI,GAAGC,IAAI,CAACC,MAAL,EAAb;;AACA,eAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGR,IAAI,CAACE,MAAzB,EAAiCM,CAAC,EAAlC,EAAsC;AACpC,gBAAMC,KAAK,GAAGT,IAAI,CAACQ,CAAD,CAAlB;;AACA,gBAAIH,IAAI,KAAKI,KAAb,EAAoB;AAClBL,cAAAA,WAAW,GAAG,IAAd;AACA;AACD;;AACDJ,YAAAA,IAAI,CAACQ,CAAD,CAAJ,GAAUH,IAAI,GAAG,CAAjB;AACD;;AACD,cAAID,WAAJ,EAAiB;AACf;AACD;AACF;AACF;AACF,KAnBD,MAmBO;AACL,UAAIH,kBAAkB,CAACE,OAAvB,EAAgC;AAC9BH,QAAAA,IAAI,GAAG,CAAC,CAAD,CAAP;AACD,OAFD,MAEO;AACLA,QAAAA,IAAI,GAAG,CAAC,CAAD,CAAP;AACD;AACF;AACF;;AACDJ,EAAAA,SAAS,CAAC,YAAM;AACd,QAAIK,kBAAkB,CAACE,OAAvB,EAAgC;AAC9BF,MAAAA,kBAAkB,CAACE,OAAnB,GAA6B,KAA7B;AACA;AACD;;AACD,WAAOJ,EAAE,EAAT,CALc,CAMd;AACD,GAPQ,EAONC,IAPM,CAAT;AAQD","sourcesContent":["/*\n * Copyright (c) 2022 Anton Bagdatyev (Tonix)\n *\n * Permission is hereby granted, free of charge, to any person\n * obtaining a copy of this software and associated documentation\n * files (the \"Software\"), to deal in the Software without\n * restriction, including without limitation the rights to use,\n * copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the\n * Software is furnished to do so, subject to the following\n * conditions:\n *\n * The above copyright notice and this permission notice shall be\n * included in all copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n * OTHER DEALINGS IN THE SOFTWARE.\n */\n\nimport { useRef, useEffect } from \"react\";\nimport { isArray } from \"js-utl\";\n\n/**\n * Hook to execute a callback each time a component updates\n * (not when it mounts on the initial render).\n *\n * @param {Function} fn The callback to execute.\n * @param {Array|undefined} [deps] Dependencies array to use.\n * @return {undefined}\n */\nexport default function useUpdateEffect(fn, deps = void 0) {\n  const isInitialRenderRef = useRef(true);\n  if (isArray(deps)) {\n    // This is needed so that the update effect is triggered on the first update\n    // even if the deps array didn't change.\n    if (deps.length) {\n      if (isInitialRenderRef.current) {\n        deps = [...deps];\n        let shouldBreak = false;\n        while (true) {\n          const rand = Math.random();\n          for (let i = 0; i < deps.length; i++) {\n            const value = deps[i];\n            if (rand !== value) {\n              shouldBreak = true;\n              break;\n            }\n            deps[i] = rand + 1;\n          }\n          if (shouldBreak) {\n            break;\n          }\n        }\n      }\n    } else {\n      if (isInitialRenderRef.current) {\n        deps = [0];\n      } else {\n        deps = [1];\n      }\n    }\n  }\n  useEffect(() => {\n    if (isInitialRenderRef.current) {\n      isInitialRenderRef.current = false;\n      return;\n    }\n    return fn();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n}\n"],"file":"useUpdateEffect.js"}